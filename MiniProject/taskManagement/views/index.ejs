<% title = 'Task List' %>
<%- include('partials/_header') %>

<div class="max-w-2xl mx-auto bg-white p-6 rounded shadow">
  <h1 class="text-2xl font-bold mb-4">Tasks</h1>

  <form action="/tasks" method="post" class="mb-4 flex gap-2">
    <input name="title" placeholder="New task..." class="flex-1 p-2 border rounded" />
    <button class="px-4 py-2 bg-blue-600 text-white rounded">Add</button>
  </form>

  <ul>
    <% if (tasks.length === 0) { %>
      <li class="text-gray-500">No tasks yet.</li>
    <% } %>

    <% tasks.forEach(task => { %>
      <li class="flex items-center justify-between py-2 border-b">
        <div>
          <form action="/tasks/<%= task.id %>/toggle?_method=PUT" method="post" style="display:inline">
            <button class="mr-3">
              <% if (task.completed) { %>✅<% } else { %>⬜<% } %>
            </button>
          </form>
          <span class="<%= task.completed ? 'line-through text-gray-400' : '' %>"><%= task.title %></span>
          <div class="text-xs text-gray-400"><%= new Date(task.createdAt).toLocaleString() %></div>
        </div>

        <form action="/tasks/<%= task.id %>?_method=DELETE" method="post" onsubmit="return confirm('Delete?')">
          <button class="px-2 py-1 bg-red-500 text-white rounded">Delete</button>
        </form>
      </li>
    <% }) %>
  </ul>
</div>

<%- include('partials/_footer') %>
